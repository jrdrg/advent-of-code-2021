// Generated by ReScript, PLEASE EDIT WITH CARE
'use strict';

var List = require("rescript/lib/js/list.js");
var $$Array = require("rescript/lib/js/array.js");
var $$String = require("rescript/lib/js/string.js");
var Caml_obj = require("rescript/lib/js/caml_obj.js");
var Caml_format = require("rescript/lib/js/caml_format.js");

var inputStr = "141\n140\n160\n161\n162\n172\n178\n185\n184\n186\n187\n195\n216\n239\n243\n247\n248\n243\n224\n230\n227\n228\n229\n231\n220\n225\n226\n246\n219\n222\n225\n226\n225\n236\n243\n251\n245\n248\n250\n253\n257\n258\n269\n272\n284\n298\n279\n280\n282\n289\n296\n299\n307\n299\n304\n307\n306\n309\n319\n325\n333\n348\n349\n362\n367\n369\n371\n373\n384\n389\n390\n404\n418\n427\n428\n429\n430\n433\n435\n423\n442\n443\n444\n445\n446\n449\n454\n472\n479\n497\n505\n506\n507\n520\n524\n526\n527\n531\n535\n534\n535\n541\n542\n521\n526\n521\n529\n531\n543\n551\n557\n574\n576\n580\n585\n606\n617\n637\n642\n643\n655\n656\n661\n662\n661\n664\n670\n676\n678\n686\n696\n697\n694\n699\n706\n719\n723\n724\n721\n722\n723\n748\n749\n750\n751\n755\n758\n759\n767\n773\n791\n796\n808\n813\n809\n820\n819\n822\n823\n828\n827\n828\n818\n827\n837\n844\n847\n848\n882\n883\n887\n889\n888\n890\n894\n895\n926\n970\n977\n989\n993\n985\n1003\n997\n1006\n1011\n1017\n1018\n1021\n1023\n1027\n1038\n1040\n1044\n1040\n1046\n1062\n1073\n1078\n1094\n1097\n1101\n1115\n1118\n1114\n1117\n1119\n1124\n1126\n1127\n1131\n1114\n1115\n1134\n1137\n1139\n1141\n1143\n1159\n1162\n1164\n1173\n1178\n1179\n1180\n1181\n1185\n1191\n1192\n1193\n1212\n1210\n1213\n1215\n1211\n1216\n1217\n1230\n1222\n1231\n1232\n1234\n1235\n1228\n1234\n1235\n1246\n1257\n1264\n1262\n1271\n1273\n1274\n1279\n1281\n1292\n1300\n1302\n1304\n1314\n1315\n1320\n1331\n1332\n1333\n1334\n1351\n1352\n1353\n1342\n1341\n1351\n1372\n1389\n1390\n1384\n1390\n1406\n1405\n1410\n1411\n1413\n1433\n1440\n1439\n1445\n1447\n1472\n1467\n1489\n1505\n1506\n1518\n1520\n1523\n1538\n1536\n1547\n1550\n1555\n1557\n1563\n1559\n1565\n1564\n1591\n1592\n1604\n1607\n1606\n1620\n1634\n1631\n1633\n1648\n1663\n1643\n1647\n1652\n1655\n1656\n1658\n1659\n1673\n1674\n1681\n1661\n1666\n1657\n1659\n1672\n1673\n1674\n1683\n1676\n1689\n1691\n1692\n1703\n1719\n1720\n1723\n1727\n1741\n1742\n1749\n1751\n1772\n1788\n1794\n1795\n1797\n1798\n1799\n1800\n1804\n1812\n1803\n1805\n1806\n1807\n1818\n1820\n1801\n1799\n1803\n1802\n1803\n1818\n1815\n1818\n1820\n1833\n1841\n1843\n1849\n1846\n1851\n1852\n1863\n1865\n1866\n1868\n1871\n1872\n1873\n1880\n1894\n1895\n1903\n1907\n1909\n1912\n1902\n1906\n1914\n1915\n1886\n1892\n1893\n1895\n1898\n1900\n1901\n1897\n1899\n1906\n1907\n1891\n1902\n1903\n1911\n1913\n1917\n1915\n1928\n1953\n1963\n1965\n1967\n1973\n1964\n1968\n1971\n1972\n1985\n1999\n1998\n2024\n2048\n2053\n2054\n2056\n2058\n2070\n2072\n2073\n2076\n2077\n2080\n2083\n2091\n2094\n2079\n2089\n2090\n2085\n2089\n2087\n2089\n2090\n2114\n2115\n2117\n2120\n2105\n2110\n2111\n2110\n2124\n2134\n2140\n2150\n2152\n2153\n2154\n2163\n2161\n2162\n2164\n2165\n2177\n2178\n2184\n2185\n2186\n2199\n2206\n2213\n2217\n2234\n2239\n2242\n2253\n2264\n2263\n2271\n2278\n2279\n2280\n2284\n2288\n2299\n2314\n2313\n2312\n2310\n2311\n2314\n2310\n2311\n2326\n2328\n2351\n2335\n2374\n2376\n2372\n2376\n2382\n2386\n2392\n2402\n2403\n2405\n2410\n2411\n2413\n2424\n2425\n2435\n2463\n2443\n2472\n2482\n2484\n2485\n2503\n2506\n2507\n2509\n2505\n2530\n2531\n2527\n2530\n2541\n2542\n2563\n2571\n2572\n2568\n2575\n2576\n2577\n2581\n2582\n2590\n2602\n2619\n2621\n2622\n2625\n2641\n2658\n2672\n2674\n2679\n2676\n2681\n2674\n2675\n2676\n2679\n2700\n2703\n2704\n2685\n2690\n2685\n2699\n2716\n2718\n2714\n2727\n2728\n2729\n2730\n2739\n2746\n2712\n2713\n2715\n2719\n2723\n2714\n2716\n2715\n2723\n2719\n2726\n2727\n2742\n2744\n2750\n2763\n2760\n2761\n2764\n2765\n2781\n2785\n2787\n2803\n2804\n2805\n2809\n2815\n2788\n2792\n2810\n2822\n2824\n2834\n2859\n2858\n2859\n2863\n2864\n2860\n2861\n2859\n2869\n2871\n2860\n2867\n2868\n2873\n2874\n2882\n2890\n2882\n2883\n2891\n2892\n2902\n2911\n2923\n2924\n2928\n2947\n2948\n2949\n2952\n2963\n2966\n2967\n2970\n2973\n2978\n2981\n2973\n2988\n3000\n3001\n3002\n3027\n3002\n3003\n3029\n3030\n3035\n3041\n3043\n3041\n3042\n3012\n3017\n3021\n3026\n3046\n3049\n3059\n3058\n3065\n3066\n3069\n3071\n3073\n3075\n3081\n3079\n3091\n3103\n3117\n3127\n3151\n3122\n3123\n3125\n3148\n3149\n3151\n3152\n3158\n3161\n3165\n3167\n3170\n3173\n3169\n3171\n3176\n3177\n3178\n3179\n3184\n3183\n3185\n3188\n3189\n3205\n3206\n3209\n3210\n3211\n3213\n3223\n3226\n3233\n3236\n3235\n3255\n3263\n3287\n3284\n3291\n3290\n3291\n3295\n3296\n3305\n3301\n3302\n3303\n3329\n3330\n3339\n3345\n3358\n3359\n3360\n3364\n3361\n3369\n3381\n3383\n3384\n3386\n3392\n3391\n3390\n3396\n3426\n3427\n3429\n3428\n3451\n3460\n3461\n3463\n3490\n3497\n3496\n3520\n3525\n3527\n3531\n3533\n3532\n3559\n3563\n3564\n3572\n3574\n3575\n3578\n3579\n3580\n3578\n3572\n3575\n3576\n3560\n3559\n3558\n3560\n3558\n3570\n3572\n3573\n3574\n3581\n3596\n3601\n3597\n3603\n3601\n3612\n3611\n3614\n3624\n3625\n3626\n3642\n3671\n3678\n3681\n3690\n3696\n3694\n3686\n3700\n3701\n3703\n3709\n3711\n3705\n3713\n3711\n3723\n3726\n3728\n3736\n3739\n3740\n3747\n3755\n3758\n3770\n3773\n3765\n3773\n3812\n3814\n3817\n3819\n3826\n3830\n3829\n3831\n3832\n3833\n3834\n3840\n3853\n3856\n3857\n3869\n3886\n3888\n3896\n3880\n3900\n3902\n3905\n3925\n3931\n3934\n3935\n3937\n3940\n3954\n3980\n3981\n3982\n3979\n3980\n3985\n3994\n3999\n4000\n4002\n4014\n4024\n4028\n4029\n4034\n4036\n4045\n4046\n4052\n4053\n4066\n4072\n4085\n4084\n4091\n4092\n4110\n4115\n4128\n4130\n4141\n4145\n4146\n4152\n4153\n4165\n4185\n4175\n4179\n4192\n4207\n4202\n4210\n4212\n4223\n4231\n4232\n4231\n4233\n4236\n4249\n4238\n4239\n4244\n4262\n4276\n4290\n4287\n4295\n4293\n4301\n4302\n4314\n4317\n4323\n4340\n4329\n4330\n4343\n4346\n4370\n4371\n4372\n4387\n4408\n4410\n4415\n4414\n4416\n4431\n4432\n4433\n4438\n4439\n4457\n4449\n4448\n4453\n4454\n4444\n4445\n4453\n4456\n4457\n4452\n4475\n4476\n4474\n4475\n4481\n4462\n4464\n4465\n4467\n4466\n4468\n4480\n4494\n4496\n4499\n4515\n4510\n4512\n4519\n4524\n4507\n4509\n4510\n4519\n4520\n4478\n4481\n4489\n4496\n4502\n4478\n4469\n4475\n4498\n4501\n4507\n4519\n4523\n4549\n4561\n4563\n4577\n4583\n4592\n4612\n4613\n4627\n4661\n4707\n4720\n4721\n4720\n4717\n4679\n4690\n4694\n4699\n4701\n4711\n4715\n4716\n4717\n4718\n4721\n4723\n4731\n4726\n4728\n4730\n4731\n4732\n4746\n4749\n4763\n4762\n4759\n4795\n4804\n4802\n4803\n4790\n4808\n4820\n4836\n4839\n4843\n4857\n4870\n4875\n4865\n4874\n4876\n4892\n4893\n4894\n4900\n4903\n4907\n4915\n4917\n4918\n4919\n4925\n4962\n4963\n4965\n4971\n4972\n4962\n4987\n4994\n4995\n4999\n5001\n5006\n5010\n5017\n5020\n5036\n5037\n5039\n5056\n5058\n5062\n5063\n5059\n5060\n5061\n5056\n5061\n5071\n5069\n5079\n5096\n5097\n5073\n5081\n5082\n5083\n5107\n5111\n5110\n5111\n5125\n5143\n5149\n5151\n5186\n5191\n5193\n5194\n5176\n5178\n5179\n5181\n5182\n5206\n5202\n5209\n5217\n5218\n5225\n5221\n5224\n5226\n5227\n5244\n5245\n5244\n5252\n5259\n5265\n5258\n5262\n5267\n5271\n5275\n5276\n5273\n5274\n5279\n5280\n5281\n5304\n5285\n5286\n5293\n5310\n5315\n5319\n5324\n5325\n5336\n5337\n5339\n5340\n5339\n5340\n5341\n5337\n5334\n5344\n5347\n5361\n5367\n5382\n5390\n5391\n5394\n5397\n5393\n5406\n5413\n5414\n5410\n5407\n5408\n5412\n5413\n5422\n5438\n5432\n5433\n5435\n5459\n5464\n5465\n5468\n5485\n5486\n5487\n5488\n5497\n5498\n5499\n5503\n5506\n5519\n5521\n5525\n5508\n5514\n5518\n5529\n5542\n5544\n5545\n5542\n5543\n5551\n5552\n5527\n5529\n5534\n5536\n5554\n5553\n5554\n5543\n5549\n5550\n5544\n5517\n5528\n5542\n5550\n5569\n5574\n5584\n5581\n5582\n5584\n5577\n5576\n5577\n5586\n5592\n5618\n5622\n5635\n5646\n5649\n5650\n5652\n5667\n5669\n5671\n5672\n5689\n5682\n5680\n5681\n5684\n5695\n5697\n5699\n5700\n5713\n5720\n5737\n5768\n5787\n5785\n5771\n5778\n5784\n5792\n5783\n5787\n5791\n5796\n5806\n5812\n5816\n5815\n5816\n5818\n5820\n5821\n5840\n5859\n5861\n5894\n5897\n5919\n5946\n5947\n5952\n5954\n5957\n5953\n5956\n5933\n5921\n5937\n5942\n5944\n5962\n5964\n5965\n5971\n5972\n5971\n5976\n6014\n6012\n6015\n5999\n6000\n6014\n5999\n6010\n6020\n6026\n6029\n6032\n6045\n6044\n6046\n6085\n6077\n6086\n6113\n6114\n6122\n6119\n6123\n6124\n6126\n6145\n6154\n6161\n6162\n6163\n6164\n6167\n6191\n6193\n6187\n6194\n6201\n6188\n6179\n6197\n6216\n6218\n6223\n6222\n6225\n6211\n6214\n6218\n6187\n6184\n6186\n6212\n6220\n6221\n6223\n6246\n6249\n6259\n6264\n6292\n6296\n6300\n6309\n6327\n6329\n6347\n6349\n6362\n6365\n6357\n6383\n6385\n6390\n6393\n6394\n6398\n6392\n6393\n6394\n6397\n6398\n6420\n6424\n6418\n6419\n6430\n6431\n6437\n6444\n6450\n6452\n6462\n6464\n6466\n6489\n6499\n6509\n6517\n6518\n6519\n6520\n6511\n6512\n6515\n6516\n6517\n6519\n6521\n6523\n6525\n6528\n6535\n6544\n6545\n6560\n6559\n6567\n6586\n6594\n6631\n6639\n6647\n6648\n6650\n6654\n6665\n6662\n6696\n6697\n6698\n6699\n6708\n6709\n6725\n6737\n6746\n6747\n6751\n6765\n6766\n6768\n6779\n6780\n6797\n6822\n6830\n6837\n6834\n6842\n6831\n6849\n6862\n6863\n6864\n6871\n6875\n6881\n6886\n6888\n6898\n6906\n6911\n6912\n6926\n6927\n6928\n6929\n6949\n6951\n6950\n6951\n6950\n6949\n6950\n6951\n6944\n6947\n6946\n6948\n6950\n6951\n6952\n6941\n6946\n6953\n6960\n6959\n6957\n6958\n6960\n6975\n6976\n6978\n6970\n6972\n6970\n6973\n6974\n6985\n6986\n6998\n6999\n7022\n7029\n7028\n7033\n7035\n7037\n7047\n7048\n7061\n7068\n7082\n7081\n7069\n7075\n7077\n7085\n7107\n7108\n7106\n7107\n7110\n7117\n7129\n7136\n7145\n7146\n7144\n7147\n7153\n7154\n7173\n7178\n7179\n7190\n7192\n7199\n7204\n7206\n7210\n7211\n7212\n7216\n7241\n7256\n7261\n7266\n7265\n7267\n7268\n7257\n7258\n7264\n7265\n7270\n7272\n7285\n7297\n7292\n7288\n7292\n7293\n7297\n7296\n7294\n7301\n7304\n7310\n7311\n7297\n7300\n7306\n7315\n7327\n7332\n7333\n7354\n7370\n7382\n7393\n7394\n7395\n7410\n7399\n7400\n7408\n7414\n7419\n7423\n7424\n7428\n7396\n7404\n7413\n7414\n7417\n7414\n7415\n7417\n7418\n7419\n7427\n7434\n7456\n7457\n7472\n7481\n7482\n7483\n7484\n7491\n7495\n7507\n7508\n7509\n7508\n7509\n7510\n7511\n7512\n7520\n7526\n7530\n7535\n7536\n7540\n7536\n7535\n7544\n7545\n7547\n7562\n7541\n7544\n7563\n7572\n7581\n7583\n7570\n7572\n7594\n7598\n7601\n7615\n7619\n7620\n7621\n7644\n7668\n7666\n7668\n7663\n7661\n7662\n7661\n7662\n7676\n7710\n7711\n7712\n7724\n7726\n7736\n7738\n7747\n7748\n7751\n7763\n7754\n7757\n7761\n7764\n7763\n7764\n7768\n7773\n7772\n7787\n7795\n7805\n7821\n7822\n7823\n7837\n7839\n7840\n7834\n7852\n7828\n7817\n7819\n7823\n7834\n7839\n7869\n7889\n7904\n7905\n7913\n7910\n7907\n7913\n7908\n7910\n7912\n7914\n7902\n7904\n7909\n7905\n7908\n7916\n7918\n7919\n7920\n7925\n7930\n7955\n7956\n7959\n7960\n7966\n7970\n7955\n7970\n7971\n7972\n7973\n7974\n7972\n7973\n7972\n7981\n7982\n7985\n7989\n7995\n8013\n8014\n8015\n8017\n8021\n8022\n8026\n8034\n8035\n8037\n8038\n8042\n8045\n8046\n8047\n8063\n8069\n8091\n8094\n8095\n8096\n8112\n8120\n8115\n8119\n8114\n8115\n8147\n8164\n8165\n8167\n8171\n8173\n8176\n8174\n8178\n8205\n8199\n8197\n8198\n8200\n8202\n8207\n8223\n8237\n8238\n8240\n8253\n8264\n8268\n8279\n8280\n8293\n8309\n8310\n8311\n8310\n8316\n8313\n8319\n8347\n8353\n8337\n8362\n8366\n8375\n8380\n8412\n8414\n8419\n8422\n8424\n8425\n8430\n8431\n8449\n8452\n8458\n8447\n8457\n8458\n8472\n8473\n8479\n8485\n8486\n8488\n8489\n8490\n8491\n8497\n8492\n8495\n8501\n8504\n8507\n8524\n8523\n8516\n8521\n8525\n8534\n8535\n8538\n8543\n8544\n8563\n8587\n8592\n8614\n8619\n8627\n8628\n8620\n8616\n8624\n8626\n8627\n8616\n8613\n8614\n8615\n8616\n8621\n8627\n8631\n8640\n8632\n8633\n8643\n8644\n8652\n8655\n8658\n8665\n8662\n8672\n8684\n8685\n8691\n8692\n8707\n8709\n8713\n8714\n8719\n8722\n8725\n8730\n8736\n8748\n8751\n8752\n8756\n8761\n8766\n8775\n8788\n8797\n8798\n8810\n8802\n8797\n8800\n8807\n8811\n8812\n8821\n8825\n8826\n8839\n8830\n8828\n8829\n8835\n8837\n8845\n8850\n8848\n8856\n8864\n8875\n8876\n8886\n8885\n8884\n8899\n8880\n8884\n8886\n8887\n8892\n8893\n8900\n8903\n8906\n8907\n8908\n8911\n8910\n8911\n8913\n8919\n8920\n8918\n8919\n8923\n8924\n8925\n8935\n8936\n8938\n8948\n8950\n8958\n8968\n8979\n8983\n8987\n8988\n8990\n8984\n8985\n8992\n9000\n9016\n9035\n9038\n9040\n9044\n9045\n9041\n9054\n9053\n9054\n9055\n9027\n9028\n9031\n9037\n9036\n9035\n9036\n9029\n9045\n9044\n9052\n9053\n9054\n9071\n9072\n9073\n9076\n9083\n9080\n9081\n9084\n9089\n9102\n9105";

var input = List.map(Caml_format.caml_int_of_string, $$String.split_on_char(/* '\n' */10, inputStr));

var isIncreased = Caml_obj.caml_lessthan;

function incrementSum(sum, prev, next) {
  if (Caml_obj.caml_lessthan(prev, next)) {
    return sum + 1 | 0;
  } else {
    return sum;
  }
}

function part1(param) {
  return List.fold_left((function (param, next) {
                  var prev = param[1];
                  var sum = param[0];
                  var newSum = prev !== undefined ? incrementSum(sum, prev, next) : sum;
                  return [
                          newSum,
                          next
                        ];
                }), [
                0,
                undefined
              ], input)[0];
}

console.log("Part 1", part1(undefined));

function part2(param) {
  return List.fold_left((function (param, next) {
                  var prevWindow = param[2];
                  var sum = param[0];
                  var len = prevWindow.length;
                  var match;
                  if (len >= 4) {
                    match = [
                      [],
                      0,
                      sum
                    ];
                  } else {
                    switch (len) {
                      case 0 :
                          match = [
                            [next],
                            0,
                            sum
                          ];
                          break;
                      case 1 :
                          var p1 = prevWindow[0];
                          match = [
                            [
                              p1,
                              next
                            ],
                            0,
                            sum
                          ];
                          break;
                      case 2 :
                          var p1$1 = prevWindow[0];
                          var p2 = prevWindow[1];
                          match = [
                            [
                              p1$1,
                              p2,
                              next
                            ],
                            0,
                            sum
                          ];
                          break;
                      case 3 :
                          var p2$1 = prevWindow[1];
                          var p3 = prevWindow[2];
                          var nextWindow = [
                            p2$1,
                            p3,
                            next
                          ];
                          var windowSum = $$Array.fold_left((function (wSum, next) {
                                  return wSum + next | 0;
                                }), 0, nextWindow);
                          var increasedCount = Caml_obj.caml_lessthan(param[1], windowSum) ? sum + 1 | 0 : sum;
                          console.log(increasedCount, nextWindow, windowSum);
                          match = [
                            nextWindow,
                            increasedCount,
                            windowSum
                          ];
                          break;
                      
                    }
                  }
                  return [
                          match[1],
                          match[2],
                          match[0]
                        ];
                }), [
                0,
                0,
                []
              ], input)[0];
}

console.log("Part 2", part2(undefined));

var exampleInputStr = "199\n200\n208\n210\n200\n207\n240\n269\n260\n263";

exports.exampleInputStr = exampleInputStr;
exports.inputStr = inputStr;
exports.input = input;
exports.isIncreased = isIncreased;
exports.incrementSum = incrementSum;
exports.part1 = part1;
exports.part2 = part2;
/* input Not a pure module */
