// Generated by ReScript, PLEASE EDIT WITH CARE
'use strict';

var List = require("rescript/lib/js/list.js");
var $$Array = require("rescript/lib/js/array.js");
var $$String = require("rescript/lib/js/string.js");
var Caml_array = require("rescript/lib/js/caml_array.js");
var Caml_format = require("rescript/lib/js/caml_format.js");

var inputStr = "111010101100\n100001001100\n000111101100\n100100000000\n001001001110\n100110101011\n001001100101\n010000010110\n011011001001\n001001000101\n001000101011\n000111101111\n011000000001\n111111010100\n101101010010\n100111100111\n101000110100\n011101101101\n010101110010\n001011101010\n010001001100\n011001001100\n000110011100\n011001011100\n000101110110\n010011110111\n011101001001\n000001000111\n111110010100\n010011000000\n101001000010\n011001010011\n101011101010\n111000100111\n011110010110\n111111111010\n100011100101\n011100110000\n010011010011\n110110110010\n001110111011\n110100011111\n101011001110\n000001100101\n101001010000\n110001111011\n011101011100\n001100100001\n000100111111\n000110110111\n011100100010\n110101100111\n100110011110\n110011110010\n010111110110\n011010100010\n100100100010\n001000111011\n100101101110\n001001111101\n111000001100\n100011000100\n101011010010\n011100011001\n111100011001\n110000000011\n101110011010\n101000010011\n111011100111\n101111111100\n101111111101\n010000101101\n011111011011\n100011001100\n010011100010\n101100101011\n010011111010\n111010010101\n000011101100\n110011110101\n101000000101\n101101001110\n010111110101\n010001011001\n100000000011\n111111010000\n001110010010\n011110111101\n111010110001\n010001011010\n100101011100\n101100000100\n000001000110\n010010101001\n110101100101\n010000001111\n001010000100\n111011111100\n011111101000\n111100111101\n011100001111\n001101111010\n110100010000\n011111001101\n111001110001\n110010000100\n000110100011\n010000100010\n110010111001\n111100111010\n110110101011\n111011001110\n111000110101\n101110100110\n011100100001\n111110100010\n001010000001\n111000111111\n110010110101\n010101010100\n100101010111\n111111101110\n100101100111\n001011101000\n110010110001\n101010000111\n000000000100\n100000100100\n110001001000\n001101010100\n010101101010\n111100100000\n111100110010\n110100111000\n111110011000\n110001100111\n100111101100\n000001100110\n110111000111\n010011000111\n110111101100\n100111100000\n010101001011\n010011100101\n110000100010\n000010001010\n010001101010\n101010011101\n100011001011\n011000111001\n011010100001\n011011011110\n010000011101\n001010101101\n110011101011\n001111011110\n111111110110\n000101100110\n001110100011\n001010111001\n011010111101\n011000001001\n010101000010\n101100011011\n001110110101\n010111010100\n010110011100\n010101000111\n110000010010\n111011110110\n100101100110\n000011110010\n100111110000\n101110100010\n100010001101\n011111010100\n111101011000\n010010111010\n011111001111\n011100000010\n111000100011\n001010000110\n000101110001\n101001000111\n111111101011\n001010000010\n110011101101\n111000100100\n010111111100\n010000100101\n000111000101\n101001000100\n000001100011\n011011111100\n100011110000\n011100011111\n000011010100\n001110111101\n101001011110\n111100011000\n001100111011\n101101010100\n110101001000\n100010000011\n001101100110\n111100101011\n001101100101\n100000000111\n011001111101\n000111110101\n100100001000\n100001000010\n011011001110\n110000110010\n010110101111\n111001111000\n100110010111\n101111100000\n110000110110\n100010000100\n001110001110\n111010110111\n010111010000\n001110111000\n000101110010\n111011001011\n000011011011\n110100011001\n101010100101\n010001111110\n011101000000\n011001111100\n101101100010\n010000101111\n010010100011\n010010010001\n100000110000\n010100111011\n011101001011\n111001011110\n010100011111\n011111111100\n110110000100\n111001010000\n111000110011\n101110010111\n011001110010\n111111000100\n000001010000\n001011010101\n000000011101\n111111110001\n100011100010\n001101011101\n011111110101\n100101111001\n100100111110\n011110010010\n010110110000\n011101000101\n001000001110\n100111011001\n100110101111\n010001001111\n110011011111\n010100000001\n111100110001\n011101000111\n010110101000\n000110110000\n111101101101\n010010111011\n010011011100\n111110101101\n101001101111\n101110001111\n010101110110\n110100100011\n000000111000\n011100011100\n111001010111\n111000000111\n001101110000\n000000110010\n000110110011\n100101110010\n000100101010\n100000110110\n111100110100\n101001101110\n011100101110\n000111011111\n100111101010\n010011000101\n011000100111\n011100011011\n011110000011\n110110111001\n011111111111\n001010101111\n110111011011\n111111000111\n101010000000\n001100001001\n101001000001\n101100111110\n011000001101\n011101001010\n011011101100\n110111000000\n100100010011\n000111110111\n000101010010\n010000001010\n010010100101\n110001100101\n010101011110\n001100110001\n001111111000\n110000001111\n001101101110\n100111000101\n001010010001\n100100110110\n010011100111\n111101010001\n010010101010\n000010101001\n100111100101\n001100011011\n011101111010\n110010000111\n011101110000\n001011001010\n110101110010\n110111100001\n111000000011\n010010111111\n010011110101\n011000101000\n000101000010\n001110000000\n101010001100\n010011101010\n101100111101\n011110101011\n011110110010\n110101100110\n010001110000\n000011000100\n011110100110\n110101101010\n100110001000\n111100000001\n001000111000\n110001000110\n000111100111\n111111011101\n000001101010\n111101011110\n110011010011\n010100101011\n110010110010\n011011111101\n101110101001\n100011001101\n010110110010\n111001100011\n101101101001\n000100110001\n001011001110\n010011000011\n101111100001\n110011010000\n000011010101\n011100111110\n110100110100\n010100001001\n100010100111\n100101000111\n011010011000\n000000101101\n001111100000\n110001101110\n110110111111\n110100111100\n001010110001\n010001100010\n100000110100\n011110011100\n111010001110\n101111110001\n110000011011\n000100001011\n110110001101\n010000100001\n011001010000\n010110100110\n001100101010\n100101101011\n111110111001\n101011110000\n000101001010\n111001001101\n110100001111\n000111110000\n000010001111\n111101011010\n000011100111\n101000100000\n100011001000\n000000100011\n011011001101\n111101111101\n010001010110\n010001100100\n110111101110\n101111101001\n011101010101\n011000001011\n000100011110\n100100100011\n000110011111\n010001010101\n001110000011\n011100100100\n101111100111\n110101010000\n000101110100\n001011100010\n101000010101\n100000100111\n100111100001\n111100001011\n100101001100\n100000000001\n101110110100\n000101011100\n010111000101\n111010001010\n100111001010\n101011110001\n100111010101\n001101111000\n110011101100\n011011011111\n111100010100\n011101011111\n001011010110\n000101100111\n001010110110\n101000000100\n110010111011\n001011000100\n110000111100\n101001001111\n011000101110\n101111110010\n110101001110\n010100111110\n110100101100\n100011010110\n011101001100\n110101101001\n110111110110\n101001011010\n001100111100\n001010100111\n100001001001\n110110100011\n010111101011\n100000010101\n011000010010\n111000100010\n100111101011\n010101011101\n111100011111\n001010111111\n010111111010\n010000111000\n000011000101\n110100110011\n101101111110\n101110000101\n011101111110\n010000011000\n011111110111\n100001000100\n010101100110\n001001000010\n010011111000\n101111111011\n001000110101\n101110101101\n100101001101\n010001111111\n000001000001\n100000010010\n001010101110\n000111110100\n011100110011\n000100001110\n011100010011\n110100111101\n000111001100\n001011011100\n000110001000\n011100011110\n100101111010\n111110011110\n101001111010\n011000010111\n011111010010\n001101101011\n100001010010\n110110001001\n101000100110\n100000000100\n111010000100\n000010101000\n111011101000\n010110100101\n100110010110\n110110000101\n011011110011\n111110101010\n011000101101\n001010011101\n001001101001\n000010010110\n100010001010\n100001101111\n110010111000\n100011100110\n011011110110\n001000010001\n011000011110\n011011010001\n100100000001\n011111001011\n001100001111\n110010111010\n000101000111\n100011011010\n011110110001\n101001000101\n111111010111\n110000010101\n101111001000\n000010111011\n100000011001\n111111111110\n101111011110\n010000101000\n010011011101\n000100000111\n110100101011\n101101100110\n011111011000\n101001001101\n000110111110\n101001010011\n011100011010\n010100110111\n101001000011\n001000101010\n011110111111\n000101100101\n111111111001\n111011100110\n000100000001\n001001001100\n110100001011\n000001001111\n111000011101\n000111001110\n010000110101\n011011110101\n000101011010\n110110111101\n010011000100\n001111011000\n001001110101\n100110000110\n010110100011\n110010101110\n001111011010\n000010110011\n110010001000\n110001000010\n100100000100\n000110000110\n001000011010\n111100001000\n011001101010\n110100110010\n111001101001\n101111001100\n101100111001\n100010100010\n101011001011\n001010111100\n111001101110\n111110011001\n001100110101\n110110010010\n001100001101\n001100110110\n101100010101\n110111110000\n100011011001\n100001111011\n010000000011\n011101011110\n010011110001\n101101011011\n000011101000\n010111011010\n111000101101\n000111000001\n111000001110\n010110011111\n100110111101\n101111001101\n101100100101\n111000110111\n110010011100\n111010000010\n011100111011\n101010001101\n000000111101\n100000100110\n001011110110\n111010111110\n100110111100\n001111001110\n010110100001\n110011110100\n000110101110\n011011000100\n010000010010\n000100110101\n100100011100\n001100001100\n101110000001\n000101000000\n110001011111\n111001101100\n111100101111\n100010110001\n111111000101\n111100111111\n011010011001\n010001000110\n011011111111\n100101001111\n010000001000\n101011101001\n011011000001\n000100000000\n101110101010\n100100110011\n010110000001\n100101000101\n000100110000\n111101010111\n000100100010\n100110100000\n011000010100\n111010100010\n010101100000\n101000001000\n011011010100\n110101001011\n101000101011\n111100000011\n001101000101\n001011110010\n111111011011\n111001001001\n001001001000\n000000000010\n111100111110\n010100101111\n110111110101\n111101000011\n100101010100\n000110001111\n110000001101\n011010011010\n000001011001\n011000111000\n011111111011\n101101101010\n110110011001\n100000111011\n110000111111\n101101010111\n001001001010\n100011011000\n101001110101\n100000101111\n100011010000\n000000001110\n101010011010\n000101111011\n110101110001\n000010011011\n000110011011\n101100101010\n100111111110\n110111111100\n110000011001\n001011001100\n111010010001\n111010101110\n111000100000\n001100110100\n110100010101\n011000011010\n011101000100\n000011100101\n101111100011\n011110000110\n000100010001\n111101000100\n111000000100\n000001111001\n100000111111\n001000001101\n100110001110\n010010111110\n000001011111\n110001011101\n101010010000\n111110110010\n111010010000\n101101000111\n111110110111\n001110100001\n111110000011\n110001001101\n001000101101\n000100110110\n110111010111\n100010100100\n110100001101\n111100110011\n001100000101\n101011001101\n000000111011\n101110011000\n100100100000\n001101001111\n001110000111\n011100011000\n001100000011\n101001011100\n110100010010\n011011110001\n000100110010\n001000010101\n101000011110\n001100100010\n010100100011\n100110001101\n111111001101\n011000111101\n101101011010\n001100000100\n101100011100\n000010110000\n100110110010\n011100110111\n111001111101\n001110010111\n101010111111\n100011101011\n110010000011\n111000010101\n101101101101\n001111100110\n000101110000\n110100000111\n010100010110\n111000010010\n101011111110\n111101010010\n011010000101\n000100010000\n001010100101\n000000110111\n010011010111\n110010101001\n110010001100\n100001111101\n011100000011\n010000000100\n111000000000\n010000100011\n101111001011\n101011110110\n110110101000\n111111011010\n001001000100\n101001011000\n001000001001\n101001111101\n110000110001\n101001010111\n110101100010\n101101111111\n101101011110\n111111011001\n111010110011\n101111000001\n010001010111\n110100000011\n100110101100\n100100101011\n010100001110\n101111101111\n111111001110\n111110111000\n010101110011\n101101001010\n100100111101\n110100100010\n100011101001\n110100111001\n101000000000\n110111101011\n101111001001\n000000101011\n111011101110\n110110001011\n001111110011\n111101100011\n100100011111\n000010000110\n000010011100\n000000101001\n000001001101\n000010101111\n100100001101\n011010101000\n001001110001\n001111101110\n010110111001\n000011011100\n010101011100\n110111111011\n011101101100\n010000001001\n001011000010\n011110001010\n101011101110\n011100111100\n000010011101\n011110010100\n010010110111\n010000000001\n100111101000\n111100001100\n101100110001\n111101000001\n100111111111\n000101101000\n111010011100\n111000001010\n011001110101\n111101111100\n110011111111\n000011000010\n101000110011\n100111011010\n110011011010\n000011101110\n111100101110\n101000001001\n011110010000\n010001110111\n101100001100\n011101101001\n001110101111\n101011011011\n001110010101\n110000100111\n111110001011\n000010110111\n100001010111\n101000010110\n101100110111\n000001010110\n100001110000\n010110010110\n000110010100\n001101011010\n001100010001\n110101011100\n111101110000\n001000111111\n001101010101\n000000011111\n000001110011\n001101010011\n100001011011\n011110101010\n010100111101\n111110100011\n110100001110\n111001001000\n101000011101\n000100011001\n111101001010\n011001100111\n101010111010\n001011110000\n110100111111\n101111011111\n000011000110\n100001110011\n110110110100\n000010010101\n001010101001\n010010110010\n111011000001\n011011011001\n000110111001\n101111010110\n100111111000\n010010111101\n101011101011\n110110011000\n101001011011\n110010001001\n001100110000\n111110110110\n001111011111\n000110010010\n111100010010\n100010101011\n110100000110\n011111011110\n001111011011\n111010011111\n010001110100\n011010101001\n011100111010\n110110011111\n101000000110\n100010101101\n011101111101\n100100001010\n110111000001\n101010111101\n010000111010\n110011111001\n001000100100\n011001111001\n000111010110\n010100001111\n111100000111\n111011111111\n001101011100\n111000100001\n010100000110\n010010110001\n000011011010\n111100011110\n101000101101\n110011110111\n000110011000\n011000011011\n110000110100\n010110011001\n101110010010\n110000111001\n001011110001\n100101100100\n110011010111\n100111110111\n111001100010\n110011000000\n011101111011\n101001111111\n111011000100\n100100011000\n010110100100\n111100010011\n101100010000\n111101111010\n111101100100\n000011101001\n101111010011\n001100011110\n010100000100\n000001110111\n011111000000\n101011010101";

var input = List.map((function (bits) {
        return $$Array.map(Caml_format.caml_int_of_string, bits.split(""));
      }), $$String.split_on_char(/* '\n' */10, inputStr));

function addArrays(arr1, arr2) {
  return $$Array.mapi((function (index, param) {
                var ones = param[1];
                var zeros = param[0];
                if (Caml_array.get(arr2, index) === 0) {
                  return [
                          zeros + 1 | 0,
                          ones
                        ];
                } else {
                  return [
                          zeros,
                          ones + 1 | 0
                        ];
                }
              }), arr1);
}

function convertToBitSums(bits) {
  var sums = function (i) {
    if (i === 0) {
      return [
              1,
              0
            ];
    } else {
      return [
              0,
              1
            ];
    }
  };
  return $$Array.map(sums, bits);
}

function getBitSums(numbers) {
  return List.fold_left((function (prev, next) {
                return prev !== undefined ? addArrays(prev, next) : convertToBitSums(next);
              }), undefined, numbers);
}

function binaryToInt(binary) {
  return $$Array.fold_left((function (sum, param) {
                return sum + param[1] * Math.pow(2, param[0]) | 0;
              }), 0, $$Array.mapi((function (index, i) {
                    return [
                            index,
                            i
                          ];
                  }), $$Array.of_list(List.rev($$Array.to_list(binary)))));
}

function getMostCommonBits(bitSums) {
  return $$Array.map((function (param) {
                if (param[0] > param[1]) {
                  return 0;
                } else {
                  return 1;
                }
              }), bitSums);
}

function getLeastCommonBits(bitSums) {
  return $$Array.map((function (param) {
                if (param[0] <= param[1]) {
                  return 0;
                } else {
                  return 1;
                }
              }), bitSums);
}

function part1(param) {
  var sums = getBitSums(input);
  var match = sums !== undefined ? [
      getMostCommonBits(sums),
      getLeastCommonBits(sums)
    ] : [
      [],
      []
    ];
  var gammaRate = binaryToInt(match[0]);
  var epsilonRate = binaryToInt(match[1]);
  return Math.imul(gammaRate, epsilonRate);
}

console.log("Part 1", part1(undefined));

function findOxygenGeneratorRating(_bitIndex, _bitValues) {
  while(true) {
    var bitValues = _bitValues;
    var bitIndex = _bitIndex;
    var sums = getBitSums(bitValues);
    var mostCommon = sums !== undefined ? getMostCommonBits(sums) : [];
    var filtered = List.filter((function(bitIndex,mostCommon){
          return function (bits) {
            return Caml_array.get(bits, bitIndex) === Caml_array.get(mostCommon, bitIndex);
          }
          }(bitIndex,mostCommon)))(bitValues);
    if (!filtered) {
      return -1;
    }
    if (!filtered.tl) {
      return binaryToInt(filtered.hd);
    }
    _bitValues = filtered;
    _bitIndex = bitIndex + 1 | 0;
    continue ;
  };
}

function findCo2ScrubberRating(_bitIndex, _bitValues) {
  while(true) {
    var bitValues = _bitValues;
    var bitIndex = _bitIndex;
    var sums = getBitSums(bitValues);
    var leastCommon = sums !== undefined ? getLeastCommonBits(sums) : [];
    var filtered = List.filter((function(bitIndex,leastCommon){
          return function (bits) {
            return Caml_array.get(bits, bitIndex) === Caml_array.get(leastCommon, bitIndex);
          }
          }(bitIndex,leastCommon)))(bitValues);
    if (!filtered) {
      return -1;
    }
    if (!filtered.tl) {
      return binaryToInt(filtered.hd);
    }
    _bitValues = filtered;
    _bitIndex = bitIndex + 1 | 0;
    continue ;
  };
}

function part2(param) {
  var oxygenGeneratorRating = findOxygenGeneratorRating(0, input);
  var co2ScrubberRating = findCo2ScrubberRating(0, input);
  return Math.imul(oxygenGeneratorRating, co2ScrubberRating);
}

console.log("Part 2", part2(undefined));

var exampleInputStr = "00100\n11110\n10110\n10111\n10101\n01111\n00111\n11100\n10000\n11001\n00010\n01010";

exports.exampleInputStr = exampleInputStr;
exports.inputStr = inputStr;
exports.input = input;
exports.addArrays = addArrays;
exports.convertToBitSums = convertToBitSums;
exports.getBitSums = getBitSums;
exports.binaryToInt = binaryToInt;
exports.getMostCommonBits = getMostCommonBits;
exports.getLeastCommonBits = getLeastCommonBits;
exports.part1 = part1;
exports.findOxygenGeneratorRating = findOxygenGeneratorRating;
exports.findCo2ScrubberRating = findCo2ScrubberRating;
exports.part2 = part2;
/* input Not a pure module */
